<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Aura: The Rainy Library</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,800;1,400&family=Plus+Jakarta+Sans:wght@300;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --amber: #ffbf00;
            --ink: #0a0a0c;
            --paper: #f1e7d0;
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.08);
        }

        body, html { 
            margin: 0; padding: 0; height: 100%; 
            background: var(--ink); color: #ececed; 
            font-family: 'Plus Jakarta Sans', sans-serif; overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        /* 1. YAÄMUR ATMOSFERÄ° (CAM EFEKTÄ°) */
        #rain-canvas {
            position: fixed; inset: 0; z-index: 1; opacity: 0.4; pointer-events: none;
        }

        .ambient-glow {
            position: fixed; bottom: -10%; left: 50%; transform: translateX(-50%);
            width: 100%; height: 70%;
            background: radial-gradient(circle, rgba(255, 191, 0, 0.15) 0%, transparent 70%);
            z-index: 2; pointer-events: none; transition: 1s;
        }

        /* 2. SAYFA YAPISI */
        .page { position: fixed; inset: 0; padding: 80px 25px 120px; display: none; overflow-y: auto; z-index: 10; }
        .page.active { display: block; animation: fadeIn 0.8s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* 3. KÄ°TAP AYRACI KARTLARI (KAYDIRILABÄ°LÄ°R) */
        .bookmark-card {
            background: var(--glass); border-left: 3px solid var(--amber);
            border-radius: 4px 25px 25px 4px; padding: 25px; margin-bottom: 20px;
            backdrop-filter: blur(20px); transition: 0.3s; position: relative;
            box-shadow: 10px 10px 30px rgba(0,0,0,0.5);
        }
        .bookmark-card:active { transform: scale(0.98); background: rgba(255,255,255,0.06); }
        .author { font-family: 'Playfair Display', serif; font-style: italic; font-size: 13px; color: var(--amber); margin-bottom: 10px; display: block; }
        .content { font-size: 16px; line-height: 1.7; opacity: 0.9; }

        /* 4. NAVÄ°GASYON (GAZ LAMBASI RUHU) */
        nav {
            position: fixed; bottom: 35px; left: 25px; right: 25px; height: 75px; 
            background: rgba(10, 10, 12, 0.9); border-radius: 40px;
            border: 1px solid var(--border); display: flex; justify-content: space-around;
            align-items: center; z-index: 10000; backdrop-filter: blur(30px);
        }
        .nav-link { font-size: 20px; opacity: 0.3; transition: 0.4s; cursor: pointer; color: white; border: none; background: none; }
        .nav-link.active { opacity: 1; color: var(--amber); text-shadow: 0 0 15px var(--amber); }

        /* 5. Ã–ZEL ODA (DM) */
        #chat-overlay {
            position: fixed; inset: 0; background: var(--ink); z-index: 50000; display: none; flex-direction: column;
        }

        /* GÄ°RÄ°Å EKRANI */
        #gate { position: fixed; inset: 0; background: #000; z-index: 100000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .gate-title { font-family: 'Playfair Display', serif; font-size: 50px; font-weight: 800; color: var(--amber); margin-bottom: 5px; }
        .btn-ink { background: var(--amber); color: #000; border: none; padding: 15px 40px; border-radius: 30px; font-weight: 800; cursor: pointer; margin-top: 30px; }
    </style>
</head>
<body>

    <canvas id="rain-canvas"></canvas>
    <div class="ambient-glow" id="main-glow"></div>

    <div id="gate">
        <div class="gate-title">Aura</div>
        <p style="letter-spacing: 5px; opacity: 0.3; font-size: 10px;">THE RAINY LIBRARY</p>
        <input type="text" id="user-name" placeholder="Ä°smin nedir?" style="background:none; border:none; border-bottom:1px solid #333; color:white; text-align:center; font-size:20px; outline:none; margin-top:40px; width:200px;">
        <button class="btn-ink" onclick="enterLibrary()">KAPIYI AÃ‡</button>
    </div>

    <div id="app" style="display:none;">
        
        <div style="position:fixed; top:45px; right:25px; z-index:20000; cursor:pointer; opacity:0.4; font-size:20px;" onclick="toggleSettings()">âš™ï¸</div>

        <div id="p-shelves" class="page active">
            <h2 style="font-family:'Playfair Display'; font-size:32px; font-style:italic; margin-bottom:30px;">KÃ¼tÃ¼phane RaflarÄ±</h2>
            <div id="shelf-list"></div>
        </div>

        <div id="p-write" class="page">
            <h2 style="font-family:'Playfair Display'; font-size:32px; font-style:italic; margin-bottom:30px;">Not BÄ±rak</h2>
            <div class="bookmark-card">
                <textarea id="note-in" style="width:100%; background:none; border:none; color:white; outline:none; height:120px; font-family:inherit; font-size:18px;" placeholder="Bu kÃ¼tÃ¼phanenin bir kÃ¶ÅŸesine fÄ±sÄ±ltÄ±nÄ± bÄ±rak..."></textarea>
                <button class="btn-ink" style="float:right; padding:10px 25px; font-size:12px;" onclick="addNote()">AYRACI BIRAK</button>
                <div style="clear:both;"></div>
            </div>
        </div>

        <div id="p-bonds" class="page">
            <h2 style="font-family:'Playfair Display'; font-size:32px; font-style:italic; margin-bottom:30px;">Frekans BaÄŸlarÄ±</h2>
            <div id="bond-list">
                <div class="bookmark-card" style="opacity:0.5; text-align:center; border:none;">HenÃ¼z bir ruhla eÅŸleÅŸmedin. Kitaplara enerji vermeyi dene.</div>
            </div>
        </div>

        <nav>
            <div class="nav-link active" onclick="tab('shelves', this)">ğŸ“–</div>
            <div class="nav-link" onclick="tab('write', this)">âœ’ï¸</div>
            <div class="nav-link" onclick="tab('bonds', this)">ğŸ•¯ï¸</div>
        </nav>
    </div>

    <div id="settings-ui" style="position:fixed; inset:0; background:rgba(0,0,0,0.98); z-index:100000; display:none; padding:60px 30px;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:50px;">
            <h2 style="font-family:'Playfair Display'; font-size:28px;">KÃ¼tÃ¼phane AyarlarÄ±</h2>
            <span onclick="toggleSettings()" style="font-size:30px;">âœ•</span>
        </div>
        <p style="opacity:0.4; font-size:11px; letter-spacing:2px; margin-bottom:20px;">IÅIK ÅÄ°DDETÄ°</p>
        <input type="range" min="0" max="50" value="15" style="width:100%; accent-color:var(--amber);" oninput="adjustGlow(this.value)">
        <p style="opacity:0.4; font-size:11px; letter-spacing:2px; margin-top:40px; margin-bottom:20px;">YAÄMUR YOÄUNLUÄU</p>
        <div style="display:flex; gap:10px;">
            <button class="btn-ink" style="background:#222; color:white; flex:1;" onclick="setRain(20)">Hafif</button>
            <button class="btn-ink" style="background:#222; color:white; flex:1;" onclick="setRain(60)">SaÄŸanak</button>
        </div>
        <button class="btn-ink" style="width:100%; margin-top:100px; background:none; border:1px solid #444; color:#666;" onclick="localStorage.clear(); location.reload();">IÅŸÄ±klarÄ± Kapat (Ã‡Ä±kÄ±ÅŸ)</button>
    </div>

    <script>
        let me = localStorage.getItem('aura_lib_user') || "";
        let notes = JSON.parse(localStorage.getItem('aura_lib_notes')) || [
            {n: "Mevlana", t: "DÃ¼n akÄ±llÄ±ydÄ±m, dÃ¼nyayÄ± deÄŸiÅŸtirmek istedim. BugÃ¼n bilgeyim, kendimi deÄŸiÅŸtiriyorum."},
            {n: "Anonim", t: "YaÄŸmurun sesinde saklÄ± bir huzur var, sadece sessiz olanlar duyar."},
            {n: "Dostoyevski", t: "Her ÅŸeyin Ã¼zerinden geÃ§ip gidilir ama hiÃ§bir ÅŸey unutulmaz."}
        ];

        // 1. GÄ°RÄ°Å MANTIÄI
        function enterLibrary() {
            const n = document.getElementById('user-name').value.trim();
            if(!n) return;
            localStorage.setItem('aura_lib_user', n);
            me = n;
            document.getElementById('gate').style.display = 'none';
            document.getElementById('app').style.display = 'block';
            renderNotes();
            initRain();
        }
        if(me) enterLibrary();

        // 2. NAVÄ°GASYON
        function tab(id, el) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
            document.getElementById('p-' + id).classList.add('active');
            el.classList.add('active');
        }

        // 3. NOT EKLEME (BOOKMARK)
        function addNote() {
            const t = document.getElementById('note-in').value.trim();
            if(!t) return;
            notes.unshift({n: me, t: t});
            localStorage.setItem('aura_lib_notes', JSON.stringify(notes));
            document.getElementById('note-in').value = '';
            renderNotes();
            tab('shelves', document.querySelectorAll('.nav-link')[0]);
        }

        function renderNotes() {
            document.getElementById('shelf-list').innerHTML = notes.map(n => `
                <div class="bookmark-card" ondbclick="matchAlert('${n.n}')">
                    <span class="author">@${n.n} bir ayrac bÄ±raktÄ±:</span>
                    <div class="content">${n.t}</div>
                    <div style="margin-top:15px; font-size:10px; opacity:0.3; letter-spacing:1px;">ENERJÄ° VERMEK Ä°Ã‡Ä°N BASILI TUT</div>
                </div>
            `).join('');
        }

        // 4. MATCH SÄ°STEMÄ° (OYUNCAKLI ETKÄ°LEÅÄ°M)
        function matchAlert(user) {
            alert(user + " ile frekansÄ±nÄ±z uyuÅŸtu! Bond (BaÄŸlar) sekmesine eklendi.");
        }

        // 5. AYARLAR
        function toggleSettings() {
            const s = document.getElementById('settings-ui');
            s.style.display = s.style.display === 'block' ? 'none' : 'block';
        }
        function adjustGlow(v) {
            document.getElementById('main-glow').style.opacity = v / 100;
        }

        // 6. YAÄMUR MOTORU (CANVAS)
        const canvas = document.getElementById('rain-canvas');
        const ctx = canvas.getContext('2d');
        let rainDrops = [];
        let rainCount = 40;

        function initRain() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            for(let i = 0; i < rainCount; i++) {
                rainDrops.push({x: Math.random() * canvas.width, y: Math.random() * canvas.height, l: Math.random() * 20, v: Math.random() * 5 + 2});
            }
            animateRain();
        }

        function setRain(count) { rainCount = count; rainDrops = []; initRain(); }

        function animateRain() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            ctx.strokeStyle = 'rgba(174,194,224,0.5)';
            ctx.lineWidth = 1;
            rainDrops.forEach(d => {
                ctx.beginPath();
                ctx.moveTo(d.x, d.y);
                ctx.lineTo(d.x, d.y + d.l);
                ctx.stroke();
                d.y += d.v;
                if(d.y > canvas.height) d.y = -20;
            });
            requestAnimationFrame(animateRain);
        }
    </script>
</body>
</html>