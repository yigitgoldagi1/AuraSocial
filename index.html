<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aura Social</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        :root { --ana-renk: #6C5CE7; --arka-plan: #F0F2F5; --beyaz: #ffffff; }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--arka-plan); margin: 0; padding: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }

        /* √úst Header */
        header { background: var(--beyaz); padding: 15px; text-align: center; border-bottom: 1px solid #ddd; font-weight: 800; color: var(--ana-renk); font-size: 1.4rem; }

        /* Hikayeler Alanƒ± */
        .stories { display: flex; gap: 10px; padding: 10px; overflow-x: auto; background: var(--beyaz); border-bottom: 1px solid #ddd; }
        .story { min-width: 60px; height: 60px; border-radius: 50%; border: 2px solid var(--ana-renk); background: #eee; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; }

        /* Sohbet ve ƒ∞√ßerik Alanƒ± */
        #main-content { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .mesaj { max-width: 80%; padding: 12px 16px; border-radius: 20px; font-size: 0.95rem; line-height: 1.4; position: relative; }
        .giden { align-self: flex-end; background: var(--ana-renk); color: white; border-bottom-right-radius: 4px; }
        .gelen { align-self: flex-start; background: white; color: #333; border-bottom-left-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

        /* Alt Men√º */
        nav { background: var(--beyaz); display: flex; justify-content: space-around; padding: 12px; border-top: 1px solid #ddd; padding-bottom: 25px; }
        .nav-item { font-size: 1.2rem; color: #666; cursor: pointer; }
        .nav-item.active { color: var(--ana-renk); }

        /* Giri≈ü Paneli */
        #giris-ekrani { position: fixed; inset: 0; background: var(--ana-renk); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 2000; color: white; }
        .giris-input { padding: 12px; border-radius: 25px; border: none; width: 80%; max-width: 300px; text-align: center; font-size: 1rem; }

        /* Yazma Alanƒ± (Sadece Sohbet Sekmesinde G√∂r√ºn√ºr) */
        .input-bar { display: none; background: white; padding: 10px; gap: 10px; border-top: 1px solid #ddd; padding-bottom: 25px; }
    </style>
</head>
<body>

<div id="giris-ekrani">
    <h1 style="font-size: 2.5rem; margin-bottom: 5px;">Aura</h1>
    <p style="opacity: 0.9; margin-bottom: 20px;">Yeni nesil sosyal aƒü</p>
    <input type="text" id="username" class="giris-input" placeholder="Kullanƒ±cƒ± adƒ±nƒ±z...">
    <button onclick="baglan()" style="margin-top: 20px; padding: 12px 40px; border-radius: 25px; border: none; background: white; color: var(--ana-renk); font-weight: bold; font-size: 1rem;">Ba≈üla</button>
</div>

<header>Aura Social</header>

<div class="stories" id="story-area">
    <div class="story">Sen</div>
    <div class="story">Yiƒüit</div>
    <div class="story">Merve</div>
</div>

<div id="main-content">
    </div>

<div class="input-bar" id="mesaj-bar">
    <input type="text" id="mesajInput" placeholder="Mesaj g√∂nder..." style="flex:1; padding: 10px; border-radius: 20px; border: 1px solid #ddd;">
    <button onclick="mesajGonder()" style="background: none; border: none; color: var(--ana-renk); font-weight: bold;">G√∂nder</button>
</div>

<nav>
    <div class="nav-item active" onclick="sekmeDegistir('sohbet')">üè†</div>
    <div class="nav-item" onclick="sekmeDegistir('kesfet')">üîç</div>
    <div class="nav-item" onclick="sekmeDegistir('profil')">üë§</div>
</nav>

<script>
    let socket;
    let username;
    let currentSekme = 'sohbet';

    function baglan() {
        username = document.getElementById('username').value;
        if (!username) return alert("ƒ∞sim yazmalƒ±sƒ±n!");
        document.getElementById('giris-ekrani').style.display = 'none';
        document.getElementById('mesaj-bar').style.display = 'flex';

        // Akƒ±llƒ± Baƒülantƒ± (Beyaz ekranƒ± √ß√∂zen kƒ±sƒ±m)
        const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
        socket = new WebSocket(protocol + '//' + window.location.host + '/ws/' + username);

        socket.onmessage = function(event) {
            const data = JSON.parse(event.data);
            if(currentSekme === 'sohbet') mesajEkle(data.user, data.text, data.user === username);
        };
    }

    function sekmeDegistir(sekme) {
        currentSekme = sekme;
        const icerik = document.getElementById('main-content');
        const bar = document.getElementById('mesaj-bar');
        
        // Aktif men√º ikonunu deƒüi≈ütir
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        
        if (sekme === 'sohbet') {
            icerik.innerHTML = '';
            bar.style.display = 'flex';
        } else if (sekme === 'kesfet') {
            icerik.innerHTML = '<h3>Ke≈üfet</h3><p>Yakƒ±ndaki ki≈üileri g√∂r...</p>';
            bar.style.display = 'none';
        } else if (sekme === 'profil') {
            icerik.innerHTML = `<h3>Profilin</h3><p>Kullanƒ±cƒ±: <b>${username}</b></p>`;
            bar.style.display = 'none';
        }
    }

    function mesajGonder() {
        const input = document.getElementById('mesajInput');
        if (input.value && socket) {
            socket.send(JSON.stringify({ text: input.value }));
            input.value = '';
        }
    }

    function mesajEkle(user, text, isMine) {
        const icerik = document.getElementById('main-content');
        const div = document.createElement('div');
        div.className = `mesaj ${isMine ? 'giden' : 'gelen'}`;
        div.innerHTML = `<small style="display:block; font-size:0.7rem; margin-bottom:3px; opacity:0.8;">${user}</small>${text}`;
        icerik.appendChild(div);
        icerik.scrollTop = icerik.scrollHeight;
    }
</script>

</body>
</html>