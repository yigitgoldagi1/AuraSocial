<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Aura Social Pro</title>
    <style>
        :root {
            --bg: #000000;
            --surface: #121212;
            --accent: #8e2de2;
            --text: #ffffff;
            --border: rgba(255,255,255,0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
            background-color: var(--bg); color: var(--text); margin: 0; height: 100vh; overflow: hidden;
        }

        /* --- SAYFA YAPISI --- */
        .page {
            position: absolute; inset: 0; opacity: 0; transform: translateY(10px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); pointer-events: none;
            display: flex; flex-direction: column; padding-bottom: 90px;
        }
        .page.active { opacity: 1; transform: translateY(0); pointer-events: auto; }

        header { padding: 60px 20px 15px; font-size: 22px; font-weight: 800; border-bottom: 1px solid var(--border); }

        /* --- PROFƒ∞L HEADER --- */
        .profile-header { padding: 30px 20px; text-align: center; }
        .profile-pic {
            width: 90px; height: 90px; border-radius: 32px; background: var(--accent);
            margin: 0 auto 15px; display: flex; align-items: center; justify-content: center;
            font-size: 32px; font-weight: bold; border: 3px solid #1a1a1a;
        }

        /* --- AYARLAR Lƒ∞STESƒ∞ --- */
        .settings-group { margin: 0 15px 20px; background: var(--surface); border-radius: 20px; overflow: hidden; }
        .setting-row {
            padding: 16px 20px; display: flex; align-items: center; gap: 15px;
            border-bottom: 1px solid var(--border); cursor: pointer; transition: 0.2s;
        }
        .setting-row:active { background: #222; }
        .icon-box { width: 32px; height: 32px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; }

        /* --- MODAL (BOTTOM SHEET) --- */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8);
            z-index: 2000; display: none; align-items: flex-end;
        }
        .modal-content {
            width: 100%; background: #1c1c1e; border-top-left-radius: 30px; border-top-right-radius: 30px;
            padding: 30px 20px 50px; transform: translateY(100%); transition: 0.3s ease-out;
        }
        .modal-overlay.active { display: flex; }
        .modal-overlay.active .modal-content { transform: translateY(0); }

        /* --- INPUTS --- */
        .edit-input {
            width: 100%; padding: 15px; background: #2c2c2e; border: 1px solid #3a3a3c;
            border-radius: 15px; color: white; font-size: 16px; margin-bottom: 20px; box-sizing: border-box;
        }

        /* --- NAV --- */
        nav { position: fixed; bottom: 0; width: 100%; height: 85px; background: rgba(0,0,0,0.8); backdrop-filter: blur(25px); border-top: 1px solid var(--border); display: flex; justify-content: space-around; padding-bottom: env(safe-area-inset-bottom); }
        .nav-item { color: #555; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 5px; }
        .nav-item.active { color: white; }
    </style>
</head>
<body>

<div id="p-discover" class="page active"><header>Ke≈üfet</header><div id="user-list" style="padding:20px; display:grid; grid-template-columns:1fr 1fr; gap:15px;"></div></div>

<div id="p-chat" class="page">
    <header id="chat-title">Sohbet</header>
    <div id="chat-box" style="flex:1; overflow-y:auto; padding:20px; display:flex; flex-direction:column; gap:10px;"></div>
    <div style="padding:15px; display:flex; gap:10px; background:#000; border-top:1px solid var(--border);">
        <input type="text" id="m-input" style="flex:1; padding:12px; background:#1a1a1a; color:white; border-radius:20px; border:none;" placeholder="Mesaj fƒ±sƒ±lda...">
        <button onclick="send()" style="background:white; width:45px; height:45px; border-radius:50%; border:none; font-weight:bold;">‚Üë</button>
    </div>
</div>

<div id="p-profile" class="page" style="overflow-y: auto;">
    <header>Profil</header>
    <div class="profile-header">
        <div class="profile-pic" id="p-avatar">?</div>
        <h2 id="p-name" style="margin:0;">ƒ∞sim</h2>
        <p id="p-bio" style="color:#888; font-size:14px; margin-top:5px;">Aura Premium √úyesi</p>
    </div>

    <div class="settings-group">
        <div class="setting-row" onclick="openModal('editModal')">
            <div class="icon-box" style="background:#007aff;">üë§</div>
            <div style="flex:1;">Profil D√ºzenle</div>
            <div style="color:#444;">‚ùØ</div>
        </div>
        <div class="setting-row" onclick="openModal('themeModal')">
            <div class="icon-box" style="background:#af52de;">üé®</div>
            <div style="flex:1;">Tema Deƒüi≈ütir</div>
            <div style="color:#444;">‚ùØ</div>
        </div>
    </div>

    <div class="settings-group">
        <div class="setting-row" onclick="logout()" style="color:#ff3b30;">
            <div class="icon-box" style="background:rgba(255,59,48,0.1);">üö™</div>
            <div style="flex:1;">√áƒ±kƒ±≈ü Yap</div>
        </div>
    </div>
</div>

<div id="editModal" class="modal-overlay" onclick="closeModal('editModal')">
    <div class="modal-content" onclick="event.stopPropagation()">
        <h3 style="margin-top:0;">Profil D√ºzenle</h3>
        <input type="text" id="new-name" class="edit-input" placeholder="Yeni ƒ∞sim">
        <button onclick="updateProfile()" style="width:100%; padding:15px; border-radius:15px; background:white; color:black; font-weight:bold; border:none;">Kaydet</button>
    </div>
</div>

<div id="themeModal" class="modal-overlay" onclick="closeModal('themeModal')">
    <div class="modal-content" onclick="event.stopPropagation()">
        <h3>Tema Se√ßimi</h3>
        <div style="display:flex; gap:10px; justify-content:center; margin-bottom:20px;">
            <div onclick="changeColor('#8e2de2')" style="width:50px; height:50px; border-radius:15px; background:#8e2de2;"></div>
            <div onclick="changeColor('#ff2d55')" style="width:50px; height:50px; border-radius:15px; background:#ff2d55;"></div>
            <div onclick="changeColor('#4cd964')" style="width:50px; height:50px; border-radius:15px; background:#4cd964;"></div>
            <div onclick="changeColor('#007aff')" style="width:50px; height:50px; border-radius:15px; background:#007aff;"></div>
        </div>
    </div>
</div>

<nav>
    <div class="nav-item active" onclick="tab('discover', 0)"><span>üîç</span><small>Ke≈üfet</small></div>
    <div class="nav-item" onclick="tab('chat', 1)"><span>üí¨</span><small>Sohbet</small></div>
    <div class="nav-item" onclick="tab('profile', 2)"><span>üë§</span><small>Profil</small></div>
</nav>

<script>
    let ws;
    let target = null;
    let user = JSON.parse(localStorage.getItem('aura_pro')) || {name: "Anonim"};

    window.onload = () => {
        if(!localStorage.getItem('aura_pro')) {
            let n = prompt("Takma adƒ±n nedir?");
            if(n) { user.name = n; localStorage.setItem('aura_pro', JSON.stringify(user)); }
        }
        document.getElementById('p-name').innerText = user.name;
        document.getElementById('p-avatar').innerText = user.name[0].toUpperCase();
        document.getElementById('p-avatar').style.background = localStorage.getItem('aura_theme') || '#8e2de2';
        startWS();
    };

    function openModal(id) { document.getElementById(id).classList.add('active'); }
    function closeModal(id) { document.getElementById(id).classList.remove('active'); }

    function updateProfile() {
        let n = document.getElementById('new-name').value;
        if(n) {
            user.name = n;
            localStorage.setItem('aura_pro', JSON.stringify(user));
            location.reload();
        }
    }

    function changeColor(hex) {
        localStorage.setItem('aura_theme', hex);
        document.getElementById('p-avatar').style.background = hex;
        closeModal('themeModal');
    }

    function startWS() {
        let p = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
        ws = new WebSocket(p + '//' + window.location.host + '/ws/' + user.name);
        ws.onmessage = (e) => {
            let d = JSON.parse(e.data);
            if(d.text && (!d.hedef || d.hedef === user.name || d.user === user.name)) {
                let b = document.getElementById('chat-box');
                let div = document.createElement('div');
                div.style = `align-self:${d.user === user.name ? 'flex-end':'flex-start'}; background:${d.user === user.name ? (localStorage.getItem('aura_theme') || '#8e2de2'):'#222'}; padding:12px 16px; border-radius:20px; max-width:75%;`;
                div.innerHTML = `<small style="display:block; opacity:0.6; font-size:10px;">${d.user}</small>${d.text}`;
                b.appendChild(div);
                b.scrollTop = b.scrollHeight;
            }
            updateList(d.user);
        };
    }

    function tab(id, idx) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById('page-' + id).classList.add('active');
        document.querySelectorAll('.nav-item')[idx].classList.add('active');
    }

    function send() {
        let i = document.getElementById('m-input');
        if(i.value && ws) { ws.send(JSON.stringify({text: i.value, hedef: target})); i.value = ''; }
    }

    function updateList(u) {
        if(u === user.name) return;
        let l = document.getElementById('user-list');
        if([...l.querySelectorAll('h4')].some(h => h.innerText === u)) return;
        let c = document.createElement('div');
        c.style = "background:#121212; border-radius:20px; padding:20px; text-align:center; border:1px solid #222;";
        c.onclick = () => { target = u; document.getElementById('chat-title').innerText = u; tab('chat', 1); };
        c.innerHTML = `<div style="width:50px; height:50px; background:#333; border-radius:15px; margin:0 auto 10px; display:flex; align-items:center; justify-content:center;">${u[0]}</div><h4>${u}</h4>`;
        l.appendChild(c);
    }

    function logout() { localStorage.clear(); location.reload(); }
</script>
</body>
</html>